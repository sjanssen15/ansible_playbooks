---
- name: Install VMware Postgres
  gather_facts: true
  become: true
  hosts: all
  vars:
    postgres_pwd: "{{ lookup('password', '/dev/null length=18 chars=ascii_letters,digits,punctuation') }}" #random generated

  tasks:
  - name: Install VMware Postgres
    user:
      name: postgres
      comment: Postgres service account
      state: present
      password: "{{ postgres_pwd | password_hash('sha512') }}"
      update_password: on_create

  - name: Present randomly generated password
    debug:
      msg: "{{ postgres_pwd }}"